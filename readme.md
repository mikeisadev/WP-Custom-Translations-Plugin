# Traduzioni personalizzate - Custom Translations Plugin

## General information
- **Author**: Michele Mincone
- **Date**: 18 October 2024
- **Version**: v1.2.0
- **Data Structure**: JSON
- **Plugin name**: Custom Translations Plugin by Michele Mincone (IT: Traduzioni Personalizzate - Plugin by Michele Mincone)
- **Developer website**: [https://michelemincone.com](https://michelemincone.com)
- **Available translatable languages**: Only one (italian for reference)
- **Plugin language**: Only italian (for now)

## Description
The Custom Translations Plugin for WordPress allows you to easily manage and customize translations for your website. Enhance your site's multilingual capabilities with user-friendly translation management.

This is an easy and ready to use WordPress plugin that through an user friendly dashboard (made in React Typescript) let's you apply translations to untraslated strings.

The plugin uses the ["gettext"](https://developer.wordpress.org/reference/hooks/gettext/) filter made available by WordPress.

The plugin saves the translations as a JSON string inside 'wp_options' table as 'ctp-translations' option key. The value is a JSON string.

On the first installation and activation, the plugin will generate a default translation file.

## Future improvements
Future versions of this plugin will provide:

- **One click auto-translations**: Automatic translations using various APIs of all the inserted strings that you want to translate
- **Multi-languages translations**: For each language, you can translate the targeted string. You'll be able to select the targeted language via a list, inside the already present user interface, to apply a translations for multi-lingual websites.
- **Improved JSON data structure to handle translations and other data**: Improvement of how data structures in JSON are handled, saved and structured
- **Text domain translations**: Each string from a plugin or theme has a specific text-domain or domain. In future versions you'll be able to translate the strings you want to translate for specific text-domains or domains to avoid string translation conflicts.
- **Per page (or per template) translations**: on each page or template you have specific and determined strings added via specific wordpress functions (for example: [__()](https://developer.wordpress.org/reference/functions/__/)) or not. Via the already existing user interface, you'll be able to specify the page template where you want to apply the translations. For example cart.php or checkout.php for woocommerce.

## Features
- Easy translation management
- User-friendly interface
- Seamless integration with WordPress
- 'gettext' WordPress filter to apply translations
- Export and import translations feature
- Pagination, search translations and translations per page for pagination
- Advice when you didn't saved translations to avoid losing progress
- (+ from version 1.2.0) plural strings translations between "_n()" function using "ngettext" filter (See on this page "How to translate plural strings").

### How to translate plural strings.
For singular strings, this plugin will take the input inside the column "String to translate" and through the wordpress php filter "gettext" it will find that string. Then, when that string is found, the translation you inserted on the second column of this plugin interface ("translated string") will be returned to apply the translation.

I want to remember that singular strings are applied to the page with the text domain with the function `__()` or `esc_html__()`.

But, how to apply translations for bot singular / plural strings?

Let's take for example WooCommerce, specifically let's look at the product page.

On the product page, under the "Add to cart" button, we have meta information about the product (piece of information generated by meta.php under templates/single-product - I'm currently writing for woocommerce version 9.3.3) like "Categories:" and "Tags:".

These words can exist both in singular ("Category:" and "Tag:") and plural ("Categories:" and "Tags:").

To add this functionality, so to choose the right string if the elements is one or multiple, WordPress let's developers use the <a href="https://developer.wordpress.org/reference/functions/_n/" target="_blank" rel="noopener noreferrer">"_n()"</a> function.

As first argument we insert the singular version of the string, as second we insert the plural version, as third we insert the number of entries for the entity we want to count (for example we can count an array of categories) and last argument is the text domain.

For example, how wordpress let's woocommerce add 'Category:' when a product has attached one category and 'Categories:' when a product has more than one categories attached?

Using the `_n()` function instead of the regular `__()` or `esc_html__()`. So the `_n()` function is a way to let others translate your theme or plugin but at the same time you can add singular or plural strings based on the entries of the iterable object or array you want to take into count (for example, an array of categories or tags for a specific product, in the case of woocommerce).

And that's is how we can solve the translation problem for strings that can be plural or singular.

Now, we have to understand that if we use the `_n()` function (or a plugin or theme uses it) we have to rely on another filter to apply our custom translations.

For `__()` function or `esc_html__()` we use the **gettext** filter. For these type of strings, that uses `_n()` function, we use the **"ngettext"** filter, so the previos one but with the letter **'n'** before.

By default, this plugin will take your string and apply the translation using the **gettetx** filter.

But to trigger the use of the **ngettext** filter, you cannot insert your string directly, but you have to trigger the usage of this method using this syntax:

*%_ctp_n(singular: "Singular string", plural: "Plural string)*

So you start with `%_ctp_n` and then you insert the singular string and the plural string separated by a colon. It's like writing a function with arguments.

Where the arguments are 'singular' and 'plural' and the function is `_ctp_n`. But you have to start with `%` to trigger the usage of the **ngettext** filter after in the plugin when you'll save your translations.

But remember that you have two columns: one for the string to translate and one for the translated string. So you have to insert the `%_ctp_n` function in the first column, the one for the string to translate, and the same function with the translations in the second column.

Let's look at an example for italian translation, if you want to translate the string "Categories:" and "Category:" you have to insert the following string:

- In the first column: `%_ctp_n(singular: "Category:", plural: "Categories:")`
- In the second column: `%_ctp_n(singular: "Categoria:", plural: "Categorie:")`

And that's it. You have to insert the `%_ctp_n` function in the first column to trigger the **ngettext** filter and to find the strings to be translated. Then insert the same function with the translations in the second column to apply the translations to singular and plural strings.

In the future I'll implement a better way to translate plural strings introducing a better user interface. For now, you'l√≤ have to use this syntax to translate singular and plural strings. In the end, it's not that difficult.

```markdown
<small>Michele Mincone - How to translate plural string with my custom translations plugin - 23 October 8:45 - Italy</small>
```

## Installation
1. Download the plugin.
2. Upload the plugin files to the `/wp-content/plugins/custom-translations` directory.
3. Activate the plugin through the 'Plugins' menu in WordPress.

## Usage
1. Navigate to the Custom Translations settings page.
3. Add or edit translations as needed adding or removing strings and their translations.
4. Save your changes.

## Changelog
### 1.0.0
- Initial release
### 1.1.0
- Improved JSON data strucure:
    - ID added inside 'translations' key
    - The structure is not a direct translations array of object but is an object with following keys:
        - 'general_info', 'meta_data' and 'translations'
    - Meta data added: published time, timestamp, uuid, id type, modified by user id, modified by user priviliges
- Export file name changed
- Minor issues resolved and bug fixing
- Major improvements on security and ID management on the front-end and back-end
- Major and little React Typescript frontend user interface improvements and code refactoring
- Code refactoring on frotend + utils functions
- Added search bar input and 'clear search' button
- Added pagination, entries per page for pagination and number of entries or search results
- Improvements on ID management, now it's only on the code, but there is the choice to select between UUID or UINT (unique integers incrementally added)
- Bug fixing on search results pagination and pagination on React Typescript frontend
- Better management on the frontend on how inputs are updated (when typing the new translation or string to translate) and how this action is made while searching
- An advice message (alert javascript message) is added if you didn't saved translations to avoid losing progress for mistake.
### 1.2.0
- Adding plural strings translations on "_n()" function of wordpress via the "ngettext" filter. See on this page **How to translate plural strings** using the custom syntax %_ctp_n(singular: "Singular", plural: "Plural"). 

## License
This plugin is licensed under the [GPLv2 or later](https://www.gnu.org/licenses/gpl-2.0.html).

## Support
For support, please visit the [official developer website (Michele Mincone)](https://michelemincone.com).